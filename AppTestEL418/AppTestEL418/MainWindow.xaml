<Window x:Class="AppTestEL418.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TEST EL418 APP" Height="700" Width="900"
        Background="#1E1E1E" Foreground="White"
        Icon="Images/logo.ico">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Ligne du haut : COM -->
            <RowDefinition Height="Auto"/>
            <!-- Ligne infos état -->
            <RowDefinition Height="*"/>
            <!-- Image + instructions -->
            <RowDefinition Height="Auto"/>
            <!-- Zone PER -->
            <RowDefinition Height="Auto"/>
            <!-- Boutons test étape -->
            <RowDefinition Height="200"/>
            <!-- Log trames -->
        </Grid.RowDefinitions>

        <!-- Ligne du haut : COM -->
        <StackPanel Orientation="Horizontal" Grid.Row="0">
            <ComboBox x:Name="cmbPorts" Width="120" Margin="0,0,10,0"/>
            <Button x:Name="btnRefresh" 
                    Background="#2D2F36" 
                    BorderBrush="#3A86FF" 
                    BorderThickness="2" 
                    Content="Rafraîchir" 
                    Foreground="White"
                    Width="80" 
                    Margin="0,0,10,0" 
                    Click="BtnRefresh_Click"/>
            <Button x:Name="btnOpen" 
                    Background="#2D2F36" 
                    BorderBrush="#3A86FF" 
                    BorderThickness="2" 
                    Foreground="White"
                    Content="Ouvrir COM" 
                    Width="100" 
                    Margin="0,0,10,0" 
                    Click="BtnOpen_Click"/>
            <Button x:Name="btnClose" 
                    Background="#2D2F36" 
                    BorderBrush="#3A86FF" 
                    BorderThickness="2" 
                    Foreground="White"
                    Content="Fermer COM" 
                    Width="100" 
                    Margin="0,0,10,0" 
                    Click="BtnClose_Click"/>
            <Ellipse x:Name="ellipseStatus" Width="20" Height="20" Fill="Red" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Infos état -->
        <StackPanel Grid.Row="1" Margin="0,10,0,10">
            <TextBlock x:Name="txtEtape" FontSize="24" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBlock x:Name="txtInstructions" FontSize="16" TextWrapping="Wrap"/>
        </StackPanel>

        <!-- Image étape -->
        <Image x:Name="imgEtape" Grid.Row="2" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center" Width="650" Height="422"/>

        <!-- Zone saisie PER (visible étape 2 uniquement) -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,10" Visibility="Collapsed" x:Name="panelPer">
            <TextBox x:Name="txtPer" 
                     Width="150" 
                     FontSize="20"
                     Margin="0,0,10,0"
                     MaxLength="8"
                     KeyDown="TxtPer_KeyDown"/>
            <Button x:Name="btnSendPer" Content="Envoyer PER" Width="120" Click="BtnSendPer_Click"/>
        </StackPanel>

        <!-- Zone DIPs -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" x:Name="panelDips" Visibility="Collapsed" VerticalAlignment="Center" HorizontalAlignment="Center">
            <TextBlock Text="État des DIPs:" 
               FontSize="22" 
               FontWeight="Bold" 
               Foreground="White" 
               HorizontalAlignment="Center" Margin="0,0,0,20"/>
            <WrapPanel x:Name="wrapDips" HorizontalAlignment="Center" />
        </StackPanel>

        <!-- Zone INPs -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" x:Name="panelInps" Visibility="Collapsed" VerticalAlignment="Center" HorizontalAlignment="Center">
            <TextBlock Text="État des INPs:" 
       FontSize="24" 
       FontWeight="Bold" 
       Foreground="White" 
       HorizontalAlignment="Center" Margin="0,0,0,20"/>
            <WrapPanel x:Name="wrapInps" HorizontalAlignment="Center" />
        </StackPanel>

        <!-- Boutons test Étape + / Étape - -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,10">
            <Button Content="Étape -" Width="100" Margin="10" Click="BtnPrevStep_Click"/>
            <Button Content="Étape +" Width="100" Margin="10" Click="BtnNextStep_Click"/>
        </StackPanel>

        <!-- Log console / trames reçues -->
        <Border Grid.Row="5" CornerRadius="10" Background="Black" BorderThickness="2" BorderBrush="#3A86FF">
            <TextBox x:Name="txtLog"
             AcceptsReturn="True"
             VerticalScrollBarVisibility="Auto"
             IsReadOnly="True"
             TextWrapping="Wrap"
             Background="Transparent"
             Foreground="Lime"
             BorderThickness="0"/>
        </Border>
    </Grid>
</Window>
